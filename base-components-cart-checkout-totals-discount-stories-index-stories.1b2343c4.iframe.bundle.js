(self.webpackChunk_woocommerce_block_library=self.webpackChunk_woocommerce_block_library||[]).push([[2817],{"./assets/js/base/components/loading-mask/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/components/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./assets/js/base/components/loading-mask/style.scss"),__webpack_require__("./node_modules/react/jsx-runtime.js"));const LoadingMask=({children,className,screenReaderLabel,showSpinner=!1,isLoading=!0})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()(className,{"wc-block-components-loading-mask":isLoading}),children:[isLoading&&showSpinner&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_3__.$j,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()({"wc-block-components-loading-mask__children":isLoading}),"aria-hidden":isLoading,children}),isLoading&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("span",{className:"screen-reader-text",children:screenReaderLabel||(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__.__)("Loading…","woo-gutenberg-products-block")})]});LoadingMask.displayName="LoadingMask",LoadingMask.__docgenInfo={description:"",methods:[],displayName:"LoadingMask",props:{showSpinner:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:""},isLoading:{defaultValue:{value:"true",computed:!1},required:!1,tsType:{name:"boolean"},description:""},children:{required:!1,tsType:{name:"union",raw:"React.ReactNode | React.ReactNode[]",elements:[{name:"ReactReactNode",raw:"React.ReactNode"},{name:"Array",elements:[{name:"ReactReactNode",raw:"React.ReactNode"}],raw:"React.ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},screenReaderLabel:{required:!1,tsType:{name:"string"},description:""}}};const __WEBPACK_DEFAULT_EXPORT__=LoadingMask;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/loading-mask/index.tsx"]={name:"LoadingMask",docgenInfo:LoadingMask.__docgenInfo,path:"assets/js/base/components/loading-mask/index.tsx"})},"./assets/js/base/components/cart-checkout/totals/discount/stories/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,RemovingCoupon:()=>RemovingCoupon,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});__webpack_require__("./node_modules/react/index.js");var chunk_2WNKQWTL=__webpack_require__("./node_modules/@storybook/client-api/node_modules/@storybook/preview-api/dist/chunk-2WNKQWTL.mjs"),currency=__webpack_require__("./storybook/custom-controls/currency.ts"),custom_controls=__webpack_require__("./storybook/custom-controls/index.ts"),build_module=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js"),loading_mask=__webpack_require__("./assets/js/base/components/loading-mask/index.tsx"),components=__webpack_require__("./packages/components/index.ts"),checkout=__webpack_require__("./packages/checkout/index.js"),utils=__webpack_require__("./assets/js/settings/shared/utils.ts"),jsx_runtime=(__webpack_require__("./assets/js/base/components/cart-checkout/totals/discount/style.scss"),__webpack_require__("./node_modules/react/jsx-runtime.js"));const filteredCartCouponsFilterArg={context:"summary"},TotalsDiscount=({cartCoupons=[],currency,isRemovingCoupon,removeCoupon,values})=>{const{total_discount:totalDiscount,total_discount_tax:totalDiscountTax}=values,discountValue=parseInt(totalDiscount,10);if(!discountValue&&0===cartCoupons.length)return null;const discountTaxValue=parseInt(totalDiscountTax,10),discountTotalValue=(0,utils.$8)("displayCartPricesIncludingTax",!1)?discountValue+discountTaxValue:discountValue,filteredCartCoupons=(0,checkout.AF)({arg:filteredCartCouponsFilterArg,filterName:"coupons",defaultValue:cartCoupons});return(0,jsx_runtime.jsx)(components.eE,{className:"wc-block-components-totals-discount",currency,description:0!==filteredCartCoupons.length&&(0,jsx_runtime.jsx)(loading_mask.Z,{screenReaderLabel:(0,build_module.__)("Removing coupon…","woo-gutenberg-products-block"),isLoading:isRemovingCoupon,showSpinner:!1,children:(0,jsx_runtime.jsx)("ul",{className:"wc-block-components-totals-discount__coupon-list",children:filteredCartCoupons.map((cartCoupon=>(0,jsx_runtime.jsx)(components.hm,{className:"wc-block-components-totals-discount__coupon-list-item",text:cartCoupon.label,screenReaderText:(0,build_module.sprintf)((0,build_module.__)("Coupon: %s","woo-gutenberg-products-block"),cartCoupon.label),disabled:isRemovingCoupon,onRemove:()=>{removeCoupon(cartCoupon.code)},radius:"large",ariaLabel:(0,build_module.sprintf)((0,build_module.__)('Remove coupon "%s"',"woo-gutenberg-products-block"),cartCoupon.label)},"coupon-"+cartCoupon.code)))})}),label:discountTotalValue?(0,build_module.__)("Discount","woo-gutenberg-products-block"):(0,build_module.__)("Coupons","woo-gutenberg-products-block"),value:discountTotalValue?-1*discountTotalValue:"-"})};TotalsDiscount.displayName="TotalsDiscount",TotalsDiscount.__docgenInfo={description:"",methods:[],displayName:"TotalsDiscount",props:{cartCoupons:{defaultValue:{value:"[]",computed:!1},required:!1,tsType:{name:"Array",elements:[{name:"LooselyMustHave",elements:[{name:"CartResponseCouponItemWithLabel"},{name:"union",raw:"'code' | 'label' | 'totals'",elements:[{name:"literal",value:"'code'"},{name:"literal",value:"'label'"},{name:"literal",value:"'totals'"}]}],raw:"LooselyMustHave<\n\tCartResponseCouponItemWithLabel,\n\t'code' | 'label' | 'totals'\n>"}],raw:"LooselyMustHave<\n\tCartResponseCouponItemWithLabel,\n\t'code' | 'label' | 'totals'\n>[]"},description:""},currency:{required:!0,tsType:{name:"Currency"},description:""},isRemovingCoupon:{required:!0,tsType:{name:"boolean"},description:""},removeCoupon:{required:!0,tsType:{name:"signature",type:"function",raw:"( couponCode: string ) => void",signature:{arguments:[{name:"couponCode",type:{name:"string"}}],return:{name:"void"}}},description:""},values:{required:!0,tsType:{name:"LooselyMustHave",elements:[{name:"CartTotalsItem"},{name:"union",raw:"'total_discount' | 'total_discount_tax'",elements:[{name:"literal",value:"'total_discount'"},{name:"literal",value:"'total_discount_tax'"}]}],raw:"LooselyMustHave<\n\tCartTotalsItem,\n\t'total_discount' | 'total_discount_tax'\n>"},description:""}}};const discount=TotalsDiscount;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/cart-checkout/totals/discount/index.tsx"]={name:"TotalsDiscount",docgenInfo:TotalsDiscount.__docgenInfo,path:"assets/js/base/components/cart-checkout/totals/discount/index.tsx"});const EXAMPLE_COUPONS=[{code:"AWSMSB",discount_type:"",label:"Awesome Storybook coupon",totals:{...currency.mD.EUR,total_discount:"5000",total_discount_tax:"250"}},{code:"STONKS",discount_type:"",label:"Most valuable coupon",totals:{...currency.mD.EUR,total_discount:"10000",total_discount_tax:"1000"}}];function extractValuesFromCoupons(coupons){return coupons.reduce(((acc,curr)=>{const totalDiscount=Number(acc.total_discount)+Number(curr.totals.total_discount),totalDiscountTax=Number(acc.total_discount_tax)+Number(curr.totals.total_discount_tax);return{total_discount:String(totalDiscount),total_discount_tax:String(totalDiscountTax)}}),{total_discount:"0",total_discount_tax:"0"})}const index_stories={title:"Base Components/Totals/Discount",component:discount,argTypes:{currency:currency.I7,removeCoupon:{action:"Removing coupon with code"}},args:{cartCoupons:EXAMPLE_COUPONS,isRemovingCoupon:!1,values:extractValuesFromCoupons(EXAMPLE_COUPONS)}},Template=args=>{const[{},setArgs]=(0,chunk_2WNKQWTL.D8)();return(0,jsx_runtime.jsx)(discount,{...args,removeCoupon:code=>{args.removeCoupon(code),setArgs({isRemovingCoupon:!0});const cartCoupons=args.cartCoupons.filter((coupon=>coupon.code!==code)),values=extractValuesFromCoupons(cartCoupons);setTimeout((()=>setArgs({cartCoupons,values,isRemovingCoupon:!1})),custom_controls.AJ)}})};Template.displayName="Template";const Default=Template.bind({});Default.args={};const RemovingCoupon=Template.bind({});RemovingCoupon.args={isRemovingCoupon:!0},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const removeCoupon = (code: string) => {\n    args.removeCoupon(code);\n    setArgs({\n      isRemovingCoupon: true\n    });\n    const cartCoupons = args.cartCoupons.filter(coupon => coupon.code !== code);\n    const values = extractValuesFromCoupons(cartCoupons);\n    setTimeout(() => setArgs({\n      cartCoupons,\n      values,\n      isRemovingCoupon: false\n    }), INTERACTION_TIMEOUT);\n  };\n  return <Discount {...args} removeCoupon={removeCoupon} />;\n}",...Default.parameters?.docs?.source}}},RemovingCoupon.parameters={...RemovingCoupon.parameters,docs:{...RemovingCoupon.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const removeCoupon = (code: string) => {\n    args.removeCoupon(code);\n    setArgs({\n      isRemovingCoupon: true\n    });\n    const cartCoupons = args.cartCoupons.filter(coupon => coupon.code !== code);\n    const values = extractValuesFromCoupons(cartCoupons);\n    setTimeout(() => setArgs({\n      cartCoupons,\n      values,\n      isRemovingCoupon: false\n    }), INTERACTION_TIMEOUT);\n  };\n  return <Discount {...args} removeCoupon={removeCoupon} />;\n}",...RemovingCoupon.parameters?.docs?.source}}};const __namedExportsOrder=["Default","RemovingCoupon"]},"./storybook/custom-controls/currency.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{QT:()=>currencies,mD:()=>currenciesAPIShape,I7:()=>currencyControl});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),dist_es2015=__webpack_require__("./node_modules/dot-case/dist.es2015/index.js");var map_keys=__webpack_require__("./assets/js/base/utils/map-keys.ts");const snakeCaseKeys=obj=>(0,map_keys.C)(obj,((_,key)=>function snakeCase(input,options){return void 0===options&&(options={}),(0,dist_es2015.$)(input,(0,tslib_es6.pi)({delimiter:"_"},options))}(key))),currencies={EUR:{code:"EUR",symbol:"€",thousandSeparator:".",decimalSeparator:",",minorUnit:2,prefix:"",suffix:"€"},USD:{code:"USD",symbol:"$",thousandSeparator:",",decimalSeparator:".",minorUnit:2,prefix:"$",suffix:""}},currenciesAPIShape=Object.fromEntries(Object.entries(currencies).map((([key,value])=>[key,snakeCaseKeys(value)]))),currencyControl={control:"select",options:currencies,mapping:Object.keys(currencies)}},"./storybook/custom-controls/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AJ:()=>INTERACTION_TIMEOUT});const INTERACTION_TIMEOUT=1500},"./node_modules/@storybook/client-api/node_modules/@storybook/preview-api/dist/chunk-2WNKQWTL.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{D8:()=>useArgs});var _storybook_channels__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/channels/dist/chunk-NH5GSF3H.mjs"),_storybook_global__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/global/dist/index.mjs"),_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/client-logger/dist/index.mjs"),_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@storybook/core-events/dist/index.mjs");Object.create,Object.defineProperty,Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getPrototypeOf,Object.prototype.hasOwnProperty;var AddonStore=class{constructor(){this.getChannel=()=>{if(!this.channel){let channel=function mockChannel(){return new _storybook_channels__WEBPACK_IMPORTED_MODULE_0__.$({transport:{setHandler:()=>{},send:()=>{}}})}();return this.setChannel(channel),channel}return this.channel},this.getServerChannel=()=>{if(!this.serverChannel)throw new Error("Accessing non-existent serverChannel");return this.serverChannel},this.ready=()=>this.promise,this.hasChannel=()=>!!this.channel,this.hasServerChannel=()=>!!this.serverChannel,this.setChannel=channel=>{this.channel=channel,this.resolve()},this.setServerChannel=channel=>{this.serverChannel=channel},this.promise=new Promise((res=>{this.resolve=()=>res(this.getChannel())}))}},KEY="__STORYBOOK_ADDONS_PREVIEW";var addons=function getAddonsStore(){return _storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]||(_storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]=new AddonStore),_storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]}();var areDepsEqual=(deps,nextDeps)=>deps.length===nextDeps.length&&deps.every(((dep,i)=>dep===nextDeps[i])),invalidHooksError=()=>new Error("Storybook preview hooks can only be called inside decorators and story functions.");function getHooksContextOrNull(){return _storybook_global__WEBPACK_IMPORTED_MODULE_1__.global.STORYBOOK_HOOKS_CONTEXT||null}function getHooksContextOrThrow(){let hooks=getHooksContextOrNull();if(null==hooks)throw invalidHooksError();return hooks}function useMemoLike(name,nextCreate,deps){let{memoizedState}=function useHook(name,callback,deps){let hooks=getHooksContextOrThrow();if("MOUNT"===hooks.currentPhase){null!=deps&&!Array.isArray(deps)&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`${name} received a final argument that is not an array (instead, received ${deps}). When specified, the final argument must be an array.`);let hook={name,deps};return hooks.currentHooks.push(hook),callback(hook),hook}if("UPDATE"===hooks.currentPhase){let hook=hooks.getNextHook();if(null==hook)throw new Error("Rendered more hooks than during the previous render.");return hook.name!==name&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`Storybook has detected a change in the order of Hooks${hooks.currentDecoratorName?` called by ${hooks.currentDecoratorName}`:""}. This will lead to bugs and errors if not fixed.`),null!=deps&&null==hook.deps&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`${name} received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.`),null!=deps&&null!=hook.deps&&deps.length!==hook.deps.length&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`The final argument passed to ${name} changed size between renders. The order and size of this array must remain constant.\nPrevious: ${hook.deps}\nIncoming: ${deps}`),(null==deps||null==hook.deps||!areDepsEqual(deps,hook.deps))&&(callback(hook),hook.deps=deps),hook}throw invalidHooksError()}(name,(hook=>{hook.memoizedState=nextCreate()}),deps);return memoizedState}function useCallback(callback,deps){return useMemoLike("useCallback",(()=>callback),deps)}function useStoryContext(){let{currentContext}=getHooksContextOrThrow();if(null==currentContext)throw invalidHooksError();return currentContext}function useArgs(){let channel=addons.getChannel(),{id:storyId,args}=useStoryContext();return[args,useCallback((updatedArgs=>channel.emit(_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__.UPDATE_STORY_ARGS,{storyId,updatedArgs})),[channel,storyId]),useCallback((argNames=>channel.emit(_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__.RESET_STORY_ARGS,{storyId,argNames})),[channel,storyId])]}},"./assets/js/base/components/cart-checkout/totals/discount/style.scss":()=>{},"./assets/js/base/components/loading-mask/style.scss":()=>{}}]);