(self.webpackChunk_woocommerce_block_library=self.webpackChunk_woocommerce_block_library||[]).push([[2274],{"./assets/js/base/components/loading-mask/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/components/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__("./assets/js/base/components/loading-mask/style.scss"),__webpack_require__("./node_modules/react/jsx-runtime.js"));const LoadingMask=({children,className,screenReaderLabel,showSpinner=!1,isLoading=!0})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()(className,{"wc-block-components-loading-mask":isLoading}),children:[isLoading&&showSpinner&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_woocommerce_blocks_components__WEBPACK_IMPORTED_MODULE_3__.$j,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()({"wc-block-components-loading-mask__children":isLoading}),"aria-hidden":isLoading,children}),isLoading&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("span",{className:"screen-reader-text",children:screenReaderLabel||(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__.__)("Loading…","woo-gutenberg-products-block")})]});LoadingMask.displayName="LoadingMask",LoadingMask.__docgenInfo={description:"",methods:[],displayName:"LoadingMask",props:{showSpinner:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:""},isLoading:{defaultValue:{value:"true",computed:!1},required:!1,tsType:{name:"boolean"},description:""},children:{required:!1,tsType:{name:"union",raw:"React.ReactNode | React.ReactNode[]",elements:[{name:"ReactReactNode",raw:"React.ReactNode"},{name:"Array",elements:[{name:"ReactReactNode",raw:"React.ReactNode"}],raw:"React.ReactNode[]"}]},description:""},className:{required:!1,tsType:{name:"string"},description:""},screenReaderLabel:{required:!1,tsType:{name:"string"},description:""}}};const __WEBPACK_DEFAULT_EXPORT__=LoadingMask;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/loading-mask/index.tsx"]={name:"LoadingMask",docgenInfo:LoadingMask.__docgenInfo,path:"assets/js/base/components/loading-mask/index.tsx"})},"./assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,ErrorState:()=>ErrorState,LoadingState:()=>LoadingState,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var react=__webpack_require__("./node_modules/react/index.js"),chunk_2WNKQWTL=__webpack_require__("./node_modules/@storybook/client-api/node_modules/@storybook/preview-api/dist/chunk-2WNKQWTL.mjs"),custom_controls=__webpack_require__("./storybook/custom-controls/index.ts"),use_dispatch=__webpack_require__("./node_modules/@wordpress/data/build-module/components/use-dispatch/use-dispatch.js"),validation=__webpack_require__("./assets/js/data/validation/index.ts"),build_module=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js"),components_button=__webpack_require__("./assets/js/base/components/button/index.tsx"),loading_mask=__webpack_require__("./assets/js/base/components/loading-mask/index.tsx"),with_instance_id=__webpack_require__("./node_modules/@wordpress/compose/build-module/higher-order/with-instance-id/index.js"),components=__webpack_require__("./packages/components/index.ts"),use_select=__webpack_require__("./node_modules/@wordpress/data/build-module/components/use-select/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),jsx_runtime=(__webpack_require__("./assets/js/base/components/cart-checkout/totals/coupon/style.scss"),__webpack_require__("./node_modules/react/jsx-runtime.js"));const TotalsCoupon=({instanceId,isLoading=!1,onSubmit,displayCouponForm=!1})=>{const[couponValue,setCouponValue]=(0,react.useState)(""),[isCouponFormHidden,setIsCouponFormHidden]=(0,react.useState)(!displayCouponForm),textInputId=`wc-block-components-totals-coupon__input-${instanceId}`,formWrapperClass=classnames_default()("wc-block-components-totals-coupon__content",{"screen-reader-text":isCouponFormHidden}),{validationErrorId}=(0,use_select.Z)((select=>({validationErrorId:select(validation.M).getValidationErrorId(textInputId)})));return(0,jsx_runtime.jsx)("div",{className:"wc-block-components-totals-coupon",children:isCouponFormHidden?(0,jsx_runtime.jsx)("a",{role:"button",href:"#wc-block-components-totals-coupon__form",className:"wc-block-components-totals-coupon-link","aria-label":(0,build_module.__)("Add a coupon","woo-gutenberg-products-block"),onClick:e=>{e.preventDefault(),setIsCouponFormHidden(!1)},children:(0,build_module.__)("Add a coupon","woo-gutenberg-products-block")}):(0,jsx_runtime.jsx)(loading_mask.Z,{screenReaderLabel:(0,build_module.__)("Applying coupon…","woo-gutenberg-products-block"),isLoading,showSpinner:!1,children:(0,jsx_runtime.jsxs)("div",{className:formWrapperClass,children:[(0,jsx_runtime.jsxs)("form",{className:"wc-block-components-totals-coupon__form",id:"wc-block-components-totals-coupon__form",children:[(0,jsx_runtime.jsx)(components.OL,{id:textInputId,errorId:"coupon",className:"wc-block-components-totals-coupon__input",label:(0,build_module.__)("Enter code","woo-gutenberg-products-block"),value:couponValue,ariaDescribedBy:validationErrorId,onChange:newCouponValue=>{setCouponValue(newCouponValue)},focusOnMount:!0,validateOnMount:!1,showError:!1}),(0,jsx_runtime.jsx)(components_button.Z,{className:"wc-block-components-totals-coupon__button",disabled:isLoading||!couponValue,showSpinner:isLoading,onClick:e=>{e.preventDefault(),void 0!==onSubmit?onSubmit(couponValue)?.then((result=>{result&&(setCouponValue(""),setIsCouponFormHidden(!0))})):(setCouponValue(""),setIsCouponFormHidden(!0))},type:"submit",children:(0,build_module.__)("Apply","woo-gutenberg-products-block")})]}),(0,jsx_runtime.jsx)(components.UB,{propertyName:"coupon",elementId:textInputId})]})})})};TotalsCoupon.displayName="TotalsCoupon",TotalsCoupon.__docgenInfo={description:"",methods:[],displayName:"TotalsCoupon",props:{isLoading:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:"Whether the component is in a loading state"},displayCouponForm:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:"Whether the coupon form is hidden"},instanceId:{required:!0,tsType:{name:"string"},description:"Instance id of the input"},onSubmit:{required:!1,tsType:{name:"signature",type:"function",raw:"( couponValue: string ) => Promise< boolean > | undefined",signature:{arguments:[{name:"couponValue",type:{name:"string"}}],return:{name:"union",raw:"Promise< boolean > | undefined",elements:[{name:"Promise",elements:[{name:"boolean"}],raw:"Promise< boolean >"},{name:"undefined"}]}}},description:"Submit handler"}}};(0,with_instance_id.Z)(TotalsCoupon);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/cart-checkout/totals/coupon/index.tsx"]={name:"TotalsCoupon",docgenInfo:TotalsCoupon.__docgenInfo,path:"assets/js/base/components/cart-checkout/totals/coupon/index.tsx"});const index_stories={title:"Base Components/Totals/Coupon",component:TotalsCoupon,args:{initialOpen:!0}},INVALID_COUPON_ERROR={hidden:!1,message:"Invalid coupon code"},Template=args=>{const[{},setArgs]=(0,chunk_2WNKQWTL.D8)();return(0,jsx_runtime.jsx)(TotalsCoupon,{...args,onSubmit:code=>(args.onSubmit?.(code),setArgs({isLoading:!0}),new Promise((resolve=>{setTimeout((()=>{setArgs({isLoading:!1}),resolve(!0)}),custom_controls.AJ)})))})};Template.displayName="Template";const Default=Template.bind({});Default.args={};const LoadingState=Template.bind({});LoadingState.args={isLoading:!0};const ErrorState=args=>{const{setValidationErrors}=(0,use_dispatch.Z)(validation.M);return setValidationErrors({coupon:INVALID_COUPON_ERROR}),(0,jsx_runtime.jsx)(TotalsCoupon,{...args})};ErrorState.displayName="ErrorState",ErrorState.decorators=[StoryComponent=>(0,jsx_runtime.jsx)(StoryComponent,{})],Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const onSubmit = (code: string) => {\n    args.onSubmit?.(code);\n    setArgs({\n      isLoading: true\n    });\n    return new Promise(resolve => {\n      setTimeout(() => {\n        setArgs({\n          isLoading: false\n        });\n        resolve(true);\n      }, INTERACTION_TIMEOUT);\n    });\n  };\n  return <TotalsCoupon {...args} onSubmit={onSubmit} />;\n}",...Default.parameters?.docs?.source}}},LoadingState.parameters={...LoadingState.parameters,docs:{...LoadingState.parameters?.docs,source:{originalSource:"args => {\n  const [{}, setArgs] = useArgs();\n  const onSubmit = (code: string) => {\n    args.onSubmit?.(code);\n    setArgs({\n      isLoading: true\n    });\n    return new Promise(resolve => {\n      setTimeout(() => {\n        setArgs({\n          isLoading: false\n        });\n        resolve(true);\n      }, INTERACTION_TIMEOUT);\n    });\n  };\n  return <TotalsCoupon {...args} onSubmit={onSubmit} />;\n}",...LoadingState.parameters?.docs?.source}}},ErrorState.parameters={...ErrorState.parameters,docs:{...ErrorState.parameters?.docs,source:{originalSource:"args => {\n  const {\n    setValidationErrors\n  } = useDispatch(VALIDATION_STORE_KEY);\n  setValidationErrors({\n    coupon: INVALID_COUPON_ERROR\n  });\n  return <TotalsCoupon {...args} />;\n}",...ErrorState.parameters?.docs?.source}}},ErrorState.__docgenInfo={description:"",methods:[],displayName:"ErrorState"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx"]={name:"ErrorState",docgenInfo:ErrorState.__docgenInfo,path:"assets/js/base/components/cart-checkout/totals/coupon/stories/index.stories.tsx"});const __namedExportsOrder=["Default","LoadingState","ErrorState"]},"./storybook/custom-controls/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AJ:()=>INTERACTION_TIMEOUT});const INTERACTION_TIMEOUT=1500},"./node_modules/@storybook/client-api/node_modules/@storybook/preview-api/dist/chunk-2WNKQWTL.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{D8:()=>useArgs});var _storybook_channels__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/channels/dist/chunk-NH5GSF3H.mjs"),_storybook_global__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/global/dist/index.mjs"),_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/client-logger/dist/index.mjs"),_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@storybook/core-events/dist/index.mjs");Object.create,Object.defineProperty,Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getPrototypeOf,Object.prototype.hasOwnProperty;var AddonStore=class{constructor(){this.getChannel=()=>{if(!this.channel){let channel=function mockChannel(){return new _storybook_channels__WEBPACK_IMPORTED_MODULE_0__.$({transport:{setHandler:()=>{},send:()=>{}}})}();return this.setChannel(channel),channel}return this.channel},this.getServerChannel=()=>{if(!this.serverChannel)throw new Error("Accessing non-existent serverChannel");return this.serverChannel},this.ready=()=>this.promise,this.hasChannel=()=>!!this.channel,this.hasServerChannel=()=>!!this.serverChannel,this.setChannel=channel=>{this.channel=channel,this.resolve()},this.setServerChannel=channel=>{this.serverChannel=channel},this.promise=new Promise((res=>{this.resolve=()=>res(this.getChannel())}))}},KEY="__STORYBOOK_ADDONS_PREVIEW";var addons=function getAddonsStore(){return _storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]||(_storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]=new AddonStore),_storybook_global__WEBPACK_IMPORTED_MODULE_1__.global[KEY]}();var areDepsEqual=(deps,nextDeps)=>deps.length===nextDeps.length&&deps.every(((dep,i)=>dep===nextDeps[i])),invalidHooksError=()=>new Error("Storybook preview hooks can only be called inside decorators and story functions.");function getHooksContextOrNull(){return _storybook_global__WEBPACK_IMPORTED_MODULE_1__.global.STORYBOOK_HOOKS_CONTEXT||null}function getHooksContextOrThrow(){let hooks=getHooksContextOrNull();if(null==hooks)throw invalidHooksError();return hooks}function useMemoLike(name,nextCreate,deps){let{memoizedState}=function useHook(name,callback,deps){let hooks=getHooksContextOrThrow();if("MOUNT"===hooks.currentPhase){null!=deps&&!Array.isArray(deps)&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`${name} received a final argument that is not an array (instead, received ${deps}). When specified, the final argument must be an array.`);let hook={name,deps};return hooks.currentHooks.push(hook),callback(hook),hook}if("UPDATE"===hooks.currentPhase){let hook=hooks.getNextHook();if(null==hook)throw new Error("Rendered more hooks than during the previous render.");return hook.name!==name&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`Storybook has detected a change in the order of Hooks${hooks.currentDecoratorName?` called by ${hooks.currentDecoratorName}`:""}. This will lead to bugs and errors if not fixed.`),null!=deps&&null==hook.deps&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`${name} received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.`),null!=deps&&null!=hook.deps&&deps.length!==hook.deps.length&&_storybook_client_logger__WEBPACK_IMPORTED_MODULE_2__.kg.warn(`The final argument passed to ${name} changed size between renders. The order and size of this array must remain constant.\nPrevious: ${hook.deps}\nIncoming: ${deps}`),(null==deps||null==hook.deps||!areDepsEqual(deps,hook.deps))&&(callback(hook),hook.deps=deps),hook}throw invalidHooksError()}(name,(hook=>{hook.memoizedState=nextCreate()}),deps);return memoizedState}function useCallback(callback,deps){return useMemoLike("useCallback",(()=>callback),deps)}function useStoryContext(){let{currentContext}=getHooksContextOrThrow();if(null==currentContext)throw invalidHooksError();return currentContext}function useArgs(){let channel=addons.getChannel(),{id:storyId,args}=useStoryContext();return[args,useCallback((updatedArgs=>channel.emit(_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__.UPDATE_STORY_ARGS,{storyId,updatedArgs})),[channel,storyId]),useCallback((argNames=>channel.emit(_storybook_core_events__WEBPACK_IMPORTED_MODULE_3__.RESET_STORY_ARGS,{storyId,argNames})),[channel,storyId])]}},"./assets/js/base/components/cart-checkout/totals/coupon/style.scss":()=>{},"./assets/js/base/components/loading-mask/style.scss":()=>{}}]);